---
title: "NBA Finals Predictions"
author: "Joshua Smith, Cody Boaz, Sean Sabour"
date: "May 9, 2016"
output: html_document
---

```{r,echo=FALSE}
library(jsonlite)
library(curl)
library(e1071)
library(rpart)
library(rpart.plot)
library(maptree)
#source("C:/Users/joshua/Downloads/lin-regr-util.R")
source("/Users/seansabour/Desktop/School/CST495 Data Science/Homework/lin-regr-util.R")
```

#Data Acquisition 
For our data acquisition we used the NBA api to pull most of our data. A large portion of this project was actually getting data, cleaning it, and exploring the data.
```{r,echo=FALSE}
player = fromJSON("http://stats.nba.com/stats/leaguedashplayerptshot?LeagueID=00&PerMode=Totals&Season=2014-15&SeasonType=Regular%20Season")
nba_stats_playoffs = fromJSON("http://stats.nba.com/stats/leaguedashteamptshot?LeagueID=00&PerMode=Totals&Season=2014-15&SeasonType=Playoffs")

teamstat_playoffs = data.frame(nba_stats_playoffs$resultSets$rowSet[1])
colnames(teamstat_playoffs) <- nba_stats_playoffs$resultSets$headers[[1]]


player_stats = data.frame(player$resultSets$rowSet[1])
colnames(player_stats) <- player$resultSets$headers[[1]]


getData = function(year){
    nba_stats_Hawks = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612737&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Celtics = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612738&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Nets = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612751&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Hornets = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612766&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Bulls = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612741&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Cavaliers = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612739&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Mavericks = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612742&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Nuggets = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612743&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Pistons = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612765&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Warriors = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612744&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Rockets = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612745&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Pacers = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612754&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Clippers = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612746&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Lakers = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612747&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Grizzlies = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612763&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Heat = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612748&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Bucks = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612749&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Timberwolves = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612750&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Pelicans = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612740&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Knicks = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612752&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Thunder = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612760&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Magic = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612753&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_76ers = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612755&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Suns = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612756&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Blazers = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612757&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Kings = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612758&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Spurs = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612759&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Raptors = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612761&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Jazz = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612762&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))
    nba_stats_Wizards = fromJSON(paste0("http://stats.nba.com/stats/teamgamelog?TeamID=1610612750&PerMode=Totals&Season=", year ,"&SeasonType=Regular%20Season"))

    # putting the data in data frame and adding headers
    playerstat_Hawks = data.frame(nba_stats_Hawks$resultSets$rowSet[1])
    colnames(playerstat_Hawks) <- nba_stats_Hawks$resultSets$headers[[1]]
    
    playerstat_Celtics = data.frame(nba_stats_Celtics$resultSets$rowSet[1])
    colnames(playerstat_Celtics) <- nba_stats_Celtics$resultSets$headers[[1]]
    
    playerstat_Nets = data.frame(nba_stats_Nets$resultSets$rowSet[1])
    colnames(playerstat_Nets) <- nba_stats_Nets$resultSets$headers[[1]]
    
    playerstat_Hornets = data.frame(nba_stats_Hornets$resultSets$rowSet[1])
    colnames(playerstat_Hornets) <- nba_stats_Hornets$resultSets$headers[[1]]
    
    playerstat_Bulls = data.frame(nba_stats_Bulls$resultSets$rowSet[1])
    colnames(playerstat_Bulls) <- nba_stats_Bulls$resultSets$headers[[1]]
    
    playerstat_Cavaliers = data.frame(nba_stats_Cavaliers$resultSets$rowSet[1])
    colnames(playerstat_Cavaliers) <- nba_stats_Cavaliers$resultSets$headers[[1]]
    
    playerstat_Mavericks = data.frame(nba_stats_Mavericks$resultSets$rowSet[1])
    colnames(playerstat_Mavericks) <- nba_stats_Mavericks$resultSets$headers[[1]]
    
    playerstat_Nuggets = data.frame(nba_stats_Nuggets$resultSets$rowSet[1])
    colnames(playerstat_Nuggets) <- nba_stats_Nuggets$resultSets$headers[[1]]
    
    playerstat_Pistons = data.frame(nba_stats_Pistons$resultSets$rowSet[1])
    colnames(playerstat_Pistons) <- nba_stats_Pistons$resultSets$headers[[1]]
    
    playerstat_Warriors = data.frame(nba_stats_Warriors$resultSets$rowSet[1])
    colnames(playerstat_Warriors) <- nba_stats_Warriors$resultSets$headers[[1]]
    
    playerstat_Rockets = data.frame(nba_stats_Rockets$resultSets$rowSet[1])
    colnames(playerstat_Rockets) <- nba_stats_Rockets$resultSets$headers[[1]]
    
    playerstat_Pacers = data.frame(nba_stats_Pacers$resultSets$rowSet[1])
    colnames(playerstat_Pacers) <- nba_stats_Pacers$resultSets$headers[[1]]
    
    playerstat_Clippers = data.frame(nba_stats_Clippers$resultSets$rowSet[1])
    colnames(playerstat_Clippers) <- nba_stats_Clippers$resultSets$headers[[1]]
    
    playerstat_Lakers = data.frame(nba_stats_Lakers$resultSets$rowSet[1])
    colnames(playerstat_Lakers) <- nba_stats_Lakers$resultSets$headers[[1]]
    
    playerstat_Grizzlies = data.frame(nba_stats_Grizzlies$resultSets$rowSet[1])
    colnames(playerstat_Grizzlies) <- nba_stats_Grizzlies$resultSets$headers[[1]]
    
    playerstat_Grizzlies = data.frame(nba_stats_Grizzlies$resultSets$rowSet[1])
    colnames(playerstat_Grizzlies) <- nba_stats_Grizzlies$resultSets$headers[[1]]
    
    playerstat_Heat = data.frame(nba_stats_Heat$resultSets$rowSet[1])
    colnames(playerstat_Heat) <- nba_stats_Heat$resultSets$headers[[1]]
    
    playerstat_Bucks = data.frame(nba_stats_Bucks$resultSets$rowSet[1])
    colnames(playerstat_Bucks) <- nba_stats_Bucks$resultSets$headers[[1]]
    
    playerstat_Timberwolves = data.frame(nba_stats_Timberwolves$resultSets$rowSet[1])
    colnames(playerstat_Timberwolves) <- nba_stats_Timberwolves$resultSets$headers[[1]]
    
    playerstat_Pelicans = data.frame(nba_stats_Pelicans$resultSets$rowSet[1])
    colnames(playerstat_Pelicans) <- nba_stats_Pelicans$resultSets$headers[[1]]
    
    playerstat_Knicks = data.frame(nba_stats_Knicks$resultSets$rowSet[1])
    colnames(playerstat_Knicks) <- nba_stats_Knicks$resultSets$headers[[1]]
    
    playerstat_Thunder = data.frame(nba_stats_Thunder$resultSets$rowSet[1])
    colnames(playerstat_Thunder) <- nba_stats_Thunder$resultSets$headers[[1]]
    
    playerstat_Magic = data.frame(nba_stats_Magic$resultSets$rowSet[1])
    colnames(playerstat_Magic) <- nba_stats_Magic$resultSets$headers[[1]]
    
    playerstat_76ers = data.frame(nba_stats_76ers$resultSets$rowSet[1])
    colnames(playerstat_76ers) <- nba_stats_76ers$resultSets$headers[[1]]
    
    playerstat_Suns = data.frame(nba_stats_Suns$resultSets$rowSet[1])
    colnames(playerstat_Suns) <- nba_stats_Suns$resultSets$headers[[1]]
    
    playerstat_Blazers = data.frame(nba_stats_Blazers$resultSets$rowSet[1])
    colnames(playerstat_Blazers) <- nba_stats_Blazers$resultSets$headers[[1]]
    
    playerstat_Kings = data.frame(nba_stats_Kings$resultSets$rowSet[1])
    colnames(playerstat_Kings) <- nba_stats_Kings$resultSets$headers[[1]]
    
    playerstat_Spurs = data.frame(nba_stats_Spurs$resultSets$rowSet[1])
    colnames(playerstat_Spurs) <- nba_stats_Spurs$resultSets$headers[[1]]
    
    playerstat_Raptors = data.frame(nba_stats_Raptors$resultSets$rowSet[1])
    colnames(playerstat_Raptors) <- nba_stats_Raptors$resultSets$headers[[1]]
    
    playerstat_Jazz = data.frame(nba_stats_Jazz$resultSets$rowSet[1])
    colnames(playerstat_Jazz) <- nba_stats_Jazz$resultSets$headers[[1]]
    
    playerstat_Wizards = data.frame(nba_stats_Wizards$resultSets$rowSet[1])
    colnames(playerstat_Wizards) <- nba_stats_Wizards$resultSets$headers[[1]]
    
    
    # Adding team name column
    playerstat_Hawks$team_name = "hawks"
    playerstat_Celtics$team_name = "celtics"
    playerstat_Nets$team_name = "nets"
    playerstat_Hornets$team_name = "hornets"
    playerstat_Bulls$team_name = "bulls"
    playerstat_Cavaliers$team_name = "cavaliers"
    playerstat_Mavericks$team_name = "mavericks"
    playerstat_Nuggets$team_name = "nuggets"
    playerstat_Pistons$team_name = "pistons"
    playerstat_Warriors$team_name = "warriors"
    playerstat_Rockets$team_name = "rockets"
    playerstat_Pacers$team_name = "pacers"
    playerstat_Clippers$team_name = "clippers"
    playerstat_Lakers$team_name = "lakers"
    playerstat_Grizzlies$team_name = "grizzlies"
    playerstat_Heat$team_name = "heat"
    playerstat_Bucks$team_name = "bucks"
    playerstat_Timberwolves$team_name = "timberwolves"
    playerstat_Pelicans$team_name = "pelicans"
    playerstat_Knicks$team_name = "knicks"
    playerstat_Thunder$team_name = "thunder"
    playerstat_Magic$team_name = "magic"
    playerstat_76ers$team_name = "sixers"
    playerstat_Suns$team_name = "suns"
    playerstat_Blazers$team_name = "blazers"
    playerstat_Kings$team_name = "kings"
    playerstat_Spurs$team_name = "spurs"
    playerstat_Raptors$team_name = "raptors"
    playerstat_Jazz$team_name = "jazz"
    playerstat_Wizards$team_name = "wizards"
    
    total_teams = rbind(playerstat_Hawks,
                    playerstat_Celtics,
                    playerstat_Nets,
                    playerstat_Hornets,
                    playerstat_Bulls,
                    playerstat_Cavaliers,
                    playerstat_Mavericks,
                    playerstat_Nuggets,
                    playerstat_Pistons,
                    playerstat_Warriors,
                    playerstat_Rockets,
                    playerstat_Pacers,
                    playerstat_Clippers,
                    playerstat_Lakers,
                    playerstat_Grizzlies,
                    playerstat_Heat,
                    playerstat_Bucks,
                    playerstat_Timberwolves,
                    playerstat_Pelicans,
                    playerstat_Knicks,
                    playerstat_Thunder,
                    playerstat_Magic,
                    playerstat_76ers,
                    playerstat_Suns,
                    playerstat_Blazers,
                    playerstat_Kings,
                    playerstat_Spurs,
                    playerstat_Raptors,
                    playerstat_Jazz,
                    playerstat_Wizards)
    names(total_teams) = tolower(names(total_teams))
    return(total_teams)
}
game_by_game14_15 = getData("2014-15")
game_by_game15_16 = getData("2015-16")

# 
franchise_data = function(year){
    hawks_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612737&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    celtics_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612738&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    nets_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612751&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    hornets_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612766&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    bulls_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612741&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    cavaliers_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612739&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    mavericks_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612742&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    nuggets_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612743&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    pistons_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612765&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    warriors_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612744&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    rockets_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612745&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    pacers_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612754&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    clippers_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612746&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    lakers_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612747&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    grizzlies_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612763&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    heat_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612748&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    bucks_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612749&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    timberwolves_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612750&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    pelicans_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612740&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    knicks_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612752&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    thunder_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612760&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    magic_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612753&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    sixers_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612755&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    suns_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612756&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    blazers_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612757&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    kings_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612758&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    spurs_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612759&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    raptors_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612761&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    jazz_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612762&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    wizards_stats = fromJSON("http://stats.nba.com/stats/teamyearbyyearstats?TeamID=1610612764&LeagueId=00&SeasonType=Regular%20Season&perMode=Totals")
    
    # Franchise Stats
    Hawks = data.frame(hawks_stats$resultSets$rowSet[1])
    colnames(Hawks) <- hawks_stats$resultSets$headers[[1]]
    
    Celtics = data.frame(celtics_stats$resultSets$rowSet[1])
    colnames(Celtics) <- celtics_stats$resultSets$headers[[1]]
    
    Nets = data.frame(nets_stats$resultSets$rowSet[1])
    colnames(Nets) <- nets_stats$resultSets$headers[[1]]
    
    Hornets = data.frame(hornets_stats$resultSets$rowSet[1])
    colnames(Hornets) <- hornets_stats$resultSets$headers[[1]]
    
    Bulls = data.frame(bulls_stats$resultSets$rowSet[1])
    colnames(Bulls) <- bulls_stats$resultSets$headers[[1]]
    
    Cavaliers = data.frame(cavaliers_stats$resultSets$rowSet[1])
    colnames(Cavaliers) <- cavaliers_stats$resultSets$headers[[1]]
    
    Mavericks = data.frame(mavericks_stats$resultSets$rowSet[1])
    colnames(Mavericks) <- mavericks_stats$resultSets$headers[[1]]
    
    Nuggets = data.frame(nuggets_stats$resultSets$rowSet[1])
    colnames(Nuggets) <- nuggets_stats$resultSets$headers[[1]]
    
    Pistons = data.frame(pistons_stats$resultSets$rowSet[1])
    colnames(Pistons) <- pistons_stats$resultSets$headers[[1]]
    
    Warriors = data.frame(warriors_stats$resultSets$rowSet[1])
    colnames(Warriors) <- warriors_stats$resultSets$headers[[1]]
    
    Rockets = data.frame(rockets_stats$resultSets$rowSet[1])
    colnames(Rockets) <- rockets_stats$resultSets$headers[[1]]
    
    Pacers = data.frame(pacers_stats$resultSets$rowSet[1])
    colnames(Pacers) <- pacers_stats$resultSets$headers[[1]]
    
    Clippers = data.frame(clippers_stats$resultSets$rowSet[1])
    colnames(Clippers) <- clippers_stats$resultSets$headers[[1]]
    
    Lakers = data.frame(lakers_stats$resultSets$rowSet[1])
    colnames(Lakers) <- lakers_stats$resultSets$headers[[1]]
    
    Grizzlies = data.frame(grizzlies_stats$resultSets$rowSet[1])
    colnames(Grizzlies) <- grizzlies_stats$resultSets$headers[[1]]
    
    Heat = data.frame(heat_stats$resultSets$rowSet[1])
    colnames(Heat) <- heat_stats$resultSets$headers[[1]]
    
    Bucks = data.frame(bucks_stats$resultSets$rowSet[1])
    colnames(Bucks) <- bucks_stats$resultSets$headers[[1]]
    
    Timberwolves = data.frame(timberwolves_stats$resultSets$rowSet[1])
    colnames(Timberwolves) <- timberwolves_stats$resultSets$headers[[1]]
    
    Pelicans = data.frame(pelicans_stats$resultSets$rowSet[1])
    colnames(Pelicans) <- pelicans_stats$resultSets$headers[[1]]
    
    Knicks = data.frame(knicks_stats$resultSets$rowSet[1])
    colnames(Knicks) <- knicks_stats$resultSets$headers[[1]]
    
    Thunder = data.frame(thunder_stats$resultSets$rowSet[1])
    colnames(Thunder) <- thunder_stats$resultSets$headers[[1]]
    
    Magic = data.frame(magic_stats$resultSets$rowSet[1])
    colnames(Magic) <- magic_stats$resultSets$headers[[1]]
    
    Sixers = data.frame(sixers_stats$resultSets$rowSet[1])
    colnames(Sixers) <- sixers_stats$resultSets$headers[[1]]
    
    Suns = data.frame(suns_stats$resultSets$rowSet[1])
    colnames(Suns) <- suns_stats$resultSets$headers[[1]]
    
    Blazers = data.frame(blazers_stats$resultSets$rowSet[1])
    colnames(Blazers) <- blazers_stats$resultSets$headers[[1]]
    
    Kings = data.frame(kings_stats$resultSets$rowSet[1])
    colnames(Kings) <- kings_stats$resultSets$headers[[1]]
    
    Spurs = data.frame(spurs_stats$resultSets$rowSet[1])
    colnames(Spurs) <- spurs_stats$resultSets$headers[[1]]
    
    Raptors = data.frame(raptors_stats$resultSets$rowSet[1])
    colnames(Raptors) <- raptors_stats$resultSets$headers[[1]]
    
    Jazz = data.frame(jazz_stats$resultSets$rowSet[1])
    colnames(Jazz) <- jazz_stats$resultSets$headers[[1]]
    
    Wizards = data.frame(wizards_stats$resultSets$rowSet[1])
    colnames(Wizards) <- wizards_stats$resultSets$headers[[1]]
    
    Hawks$NBA_FINALS_APPEARANCE = 4
    Celtics$NBA_FINALS_APPEARANCE = 21
    Nets$NBA_FINALS_APPEARANCE = 2
    Hornets$NBA_FINALS_APPEARANCE = 0
    Bulls$NBA_FINALS_APPEARANCE = 6
    Cavaliers$NBA_FINALS_APPEARANCE = 2
    Mavericks$NBA_FINALS_APPEARANCE = 2
    Nuggets$NBA_FINALS_APPEARANCE = 0
    Pistons$NBA_FINALS_APPEARANCE = 7
    Warriors$NBA_FINALS_APPEARANCE = 7
    Rockets$NBA_FINALS_APPEARANCE = 4
    Pacers$NBA_FINALS_APPEARANCE = 1
    Clippers$NBA_FINALS_APPEARANCE = 0
    Lakers$NBA_FINALS_APPEARANCE = 31
    Grizzlies$NBA_FINALS_APPEARANCE = 0
    Heat$NBA_FINALS_APPEARANCE = 4
    Bucks$NBA_FINALS_APPEARANCE = 2
    Timberwolves$NBA_FINALS_APPEARANCE = 0
    Pelicans$NBA_FINALS_APPEARANCE = 0
    Knicks$NBA_FINALS_APPEARANCE = 8
    Thunder$NBA_FINALS_APPEARANCE = 1
    Magic$NBA_FINALS_APPEARANCE = 2
    Sixers$NBA_FINALS_APPEARANCE = 9
    Suns$NBA_FINALS_APPEARANCE = 2
    Blazers$NBA_FINALS_APPEARANCE = 3
    Kings$NBA_FINALS_APPEARANCE = 1
    Spurs$NBA_FINALS_APPEARANCE = 6
    Raptors$NBA_FINALS_APPEARANCE = 0
    Jazz$NBA_FINALS_APPEARANCE = 2
    Wizards$NBA_FINALS_APPEARANCE = 4
    
    teams = list( Hawks[Hawks$YEAR == year, ], Celtics[Celtics$YEAR == year, ],
                  Nets[Nets$YEAR == year, ], Hornets[Hornets$YEAR == year, ], 
                  Bulls[Bulls$YEAR == year, ], Cavaliers[Cavaliers$YEAR == year, ],
                  Mavericks[Mavericks$YEAR == year, ], Nuggets[Nuggets$YEAR == year, ],
                  Pistons[Pistons$YEAR == year, ], Warriors[Warriors$YEAR == year, ],
                  Rockets[Rockets$YEAR == year, ], Pacers[Pacers$YEAR == year, ],
                  Clippers[Clippers$YEAR == year, ], Lakers[Lakers$YEAR == year, ],
                  Grizzlies[Grizzlies$YEAR == year, ], Heat[Heat$YEAR == year, ],
                  Bucks[Bucks$YEAR == year, ], Timberwolves[Timberwolves$YEAR == year, ],
                  Pelicans[Pelicans$YEAR == year, ], Knicks[Knicks$YEAR == year, ],
                  Thunder[Thunder$YEAR == year, ], Magic[Magic$YEAR == year, ],
                  Sixers[Sixers$YEAR == year, ], Suns[Suns$YEAR == year, ],
                  Blazers[Blazers$YEAR == year, ], Kings[Kings$YEAR == year, ],
                  Spurs[Spurs$YEAR == year, ], Raptors[Raptors$YEAR == year, ], 
                  Jazz[Jazz$YEAR == year, ], Wizards[Wizards$YEAR == year, ])
    
    
    
    team_season_stats = Reduce(function(...) merge(..., all=TRUE), teams)
    
    team_season_stats$WIN_PCT =  as.numeric(levels(team_season_stats$WIN_PCT))[team_season_stats$WIN_PCT]
    team_season_stats$PTS_RANK =  as.numeric(levels(team_season_stats$PTS_RANK))[team_season_stats$PTS_RANK]
    team_season_stats$FG3_PCT =  as.numeric(levels(team_season_stats$FG3_PCT))[team_season_stats$FG3_PCT]
    team_season_stats$FG3A =  as.numeric(levels(team_season_stats$FG3A))[team_season_stats$FG3A]
    team_season_stats$FG3M =  as.numeric(levels(team_season_stats$FG3M))[team_season_stats$FG3M]
    team_season_stats$FG_PCT =  as.numeric(levels(team_season_stats$FG_PCT))[team_season_stats$FG_PCT]
    team_season_stats$FGA =  as.numeric(levels(team_season_stats$FGA))[team_season_stats$FTA]
    team_season_stats$FGM =  as.numeric(levels(team_season_stats$FGM))[team_season_stats$FTM]
    team_season_stats$FT_PCT =  as.numeric(levels(team_season_stats$FT_PCT))[team_season_stats$FT_PCT]
    team_season_stats$FTA =  as.numeric(levels(team_season_stats$FTA))[team_season_stats$FTA]
    team_season_stats$FTM =  as.numeric(levels(team_season_stats$FTM))[team_season_stats$FTM]
    team_season_stats$OREB =  as.numeric(levels(team_season_stats$OREB))[team_season_stats$OREB]
    team_season_stats$DREB =  as.numeric(levels(team_season_stats$DREB))[team_season_stats$DREB]
    team_season_stats$REB =  as.numeric(levels(team_season_stats$REB))[team_season_stats$REB]
    team_season_stats$AST =  as.numeric(levels(team_season_stats$AST))[team_season_stats$AST]
    team_season_stats$PF =  as.numeric(levels(team_season_stats$PF))[team_season_stats$PF]
    team_season_stats$STL =  as.numeric(levels(team_season_stats$STL))[team_season_stats$STL]
    team_season_stats$BLK =  as.numeric(levels(team_season_stats$BLK))[team_season_stats$BLK]
    team_season_stats$PTS =  as.numeric(levels(team_season_stats$PTS))[team_season_stats$PTS]
    
    return(team_season_stats)
}
team_season_stats15_16 = franchise_data("2015-16")

```

#Data cleaning
After going through many trial and error runs, we noticed that alot of our data wasn't working with our model because they were factors with levels. We converted these to numeric, deleted any duplicate rows, and changed categorial values into numerical values.
```{r}
# combining the data frames for teams
cleanData = function(total_teams) {
    x = grep(pattern= "[@]",total_teams$matchup) 
    total_teams$away[x] = 1
    total_teams$away[-x] = 0
    
    total_teams$game_date = sort(as.Date(total_teams$game_date,format = "%b %d, %Y"))
    total_teams$game_id = as.numeric(levels(total_teams$game_id))[total_teams$game_id]
    total_teams$pts = as.numeric(levels(total_teams$pts))[total_teams$pts]
    total_teams$fgm = as.numeric(levels(total_teams$fgm))[total_teams$fgm]
    total_teams$fg3m = as.numeric(levels(total_teams$fg3m))[total_teams$fg3m]
    total_teams$fga = as.numeric(levels(total_teams$fga))[total_teams$fga]
    total_teams$fg3a = as.numeric(levels(total_teams$fg3a))[total_teams$fg3a]
    total_teams$ftm = as.numeric(levels(total_teams$ftm))[total_teams$ftm]
    total_teams$fta = as.numeric(levels(total_teams$fta))[total_teams$fta]
    total_teams$oreb = as.numeric(levels(total_teams$oreb))[total_teams$oreb]
    total_teams$dreb = as.numeric(levels(total_teams$dreb))[total_teams$dreb]
    total_teams$ast = as.numeric(levels(total_teams$ast))[total_teams$ast]
    total_teams$stl = as.numeric(levels(total_teams$stl))[total_teams$stl]
    total_teams$blk = as.numeric(levels(total_teams$blk))[total_teams$blk]
    total_teams$tov = as.numeric(levels(total_teams$tov))[total_teams$tov]
    total_teams$fg_pct = as.numeric(levels(total_teams$fg_pct))[total_teams$fg_pct]
    total_teams$ft_pct = as.numeric(levels(total_teams$ft_pct))[total_teams$ft_pct]
    total_teams$fg3_pct = as.numeric(levels(total_teams$fg3_pct))[total_teams$fg3_pct]
    total_teams$pf = as.numeric(levels(total_teams$pf))[total_teams$pf]
    total_teams$reb = as.numeric(levels(total_teams$reb))[total_teams$reb]
    total_teams$min = as.numeric(levels(total_teams$min))[total_teams$min]
    total_teams$wl = as.character(levels(total_teams$wl))[total_teams$wl]
    total_teams$wl = ifelse(total_teams$wl == "W", 1, 0)
    away = total_teams[total_teams$away == 1,]
    home = total_teams[total_teams$away == 0,]
    
    #take out dups
    away = away[!duplicated(away$game_id),]
    home = home[!duplicated(home$game_id),]
    
    home = home[order(home$game_id),]
    away = away[order(away$game_id),]
    
    home = home[home$game_id %in% away$game_id,]
    away = away[away$game_id %in% home$game_id,]

    total_teams = cbind(home, away)
    
    names(total_teams) = c( "team_id",   "game_id",   "game_date", "matchup",        "wl",        "min",      
     "fgm",       "fga",       "fg_pct",    "fg3m",      "fg3a",      "fg3_pct",  
     "ftm",       "fta",       "ft_pct",    "oreb",      "dreb",      "reb",      
     "ast",       "stl",       "blk",       "tov",       "pf",        "pts",      
     "team_name", "away",      "team_id_opp",   "game_id_opp",   "game_date_opp", "matchup_opp",  
     "wl_opp",    "min_opp",   "fgm_opp",   "fga_opp",   "fg_pct_opp", "fg3m_opp",  
     "fg3a_opp",  "fg3_pct_opp", "ftm_opp", "fta_opp",    "ft_pct_opp", "oreb_opp", 
     "dreb_opp",  "reb_opp",    "ast_opp",  "stl_opp",    "blk_opp",    "tov_opp",  
     "pf_opp",    "pts_opp" ,   "team_name_opp", "away_opp")
    return(total_teams)
}
game_by_game14_15 = cleanData(game_by_game14_15)
game_by_game15_16 = cleanData(game_by_game15_16)
```

<br>
<br>
<br>
<br>
<br>

#Data Exploration
In the graph below, we can see the teams that are top points ranking, like the Golden State Warriors, are also having the highest win percentage. Below that graph we can see the teams that made the NBA Finals and how they are currently doing. Poor Lakers aren't doing so well this season.
```{r}
## Plot Points Rank vs Win %
par(mfrow=c(1,1))
plot(team_season_stats15_16$PTS_RANK ~ team_season_stats15_16$WIN_PCT,xlim=c(0,1),ylim=c(0,32),col="dodgerblue",pch=16,xlab="Win Ratio",ylab="Points Ranking",main="Points Ranking vs Win Ratio")
text(team_season_stats15_16$PTS_RANK ~ team_season_stats15_16$WIN_PCT ,labels=team_season_stats15_16$TEAM_NAME, cex= 0.5, pos=3)
abline(v=mean(team_season_stats15_16$WIN_PCT))

##PLOTS Finals Appearances vs Current Win %
plot(team_season_stats15_16$NBA_FINALS_APPEARANCE ~ team_season_stats15_16$WIN_PCT,xlim=c(0,1),ylim=c(0,32),col="dodgerblue",pch=16,xlab="Win Ratio",ylab="Finals Appearances",main="Finals Appearances vs. Current Win Ratio")
text(team_season_stats15_16$NBA_FINALS_APPEARANCE ~ team_season_stats15_16$WIN_PCT,labels=team_season_stats15_16$TEAM_NAME, cex= 0.5, pos=3)

```

<br>
<br>

Taking a look at the features fg3_pct, fg3m, and fg3a look related, so does ast and fgm.
```{r}
plot(~ away  + fgm + stl + blk + ast + fg3_pct + fg3a + fg3m, data = game_by_game15_16)
```
<br>
<br>

Looks like the grizzlies have hightest point median. There are some more than 3/2 times the upper quartile outliers with the pistons and lakers
. 
```{r}
plot(game_by_game15_16$fg_pct ~ game_by_game15_16$team_id, col=c("firebrick"), xaxt='n', xlab="Team Names", ylab="Field goal percentage")
axis(1, at=1:30, labels=game_by_game15_16$team_name[1:30], las=2, cex.axis= 0.6)
```
<br>
<br>

Looks like the grizzlies have hightest 3 point median. There are some more than 3/2 times the upper quartile outliers with the kings and pacers. 
```{r}
plot(game_by_game15_16$fg3_pct ~ game_by_game15_16$team_id, col=c("firebrick"), xaxt='n', xlab="Team Names", ylab="3 pointers percentage")
axis(1, at=1:30, labels=game_by_game15_16$team_name[1:30], las=2, cex.axis= 0.6)
```
<br>
<br>

Looks like the Pistons have hightest personal fouls median. There are lot more 3/2 times the upper quartile outliers than lower. I would think that high foul teams would give their opponets an advatage to score more points.
```{r}
plot(game_by_game15_16$pf ~ game_by_game15_16$team_id, col=c("firebrick"), xaxt='n', xlab="Team Names", ylab="Personal fouls")
axis(1, at=1:30, labels=game_by_game15_16$team_name[1:30], las=2, cex.axis= 0.6)
```
<br>
<br>

Looks like the Grizzies have hightest total points median. There are lot more 3/2 times the upper quartile outliers than lower.

```{r}
plot(game_by_game15_16$pts ~ game_by_game15_16$team_id, col=c("firebrick"), xaxt='n', xlab="Team Names", ylab="Total points")
axis(1, at=1:30, labels=game_by_game15_16$team_name[1:30], las=2, cex.axis= 0.6)
```
<br>
<br>

These three plots are the related ones that I stated in the first plot.
```{r}
plot(game_by_game15_16$fg3m ~ game_by_game15_16$fg3_pct, col=c("firebrick", "blue"), pch=16)

plot(game_by_game15_16$fgm ~ game_by_game15_16$ast, col=c("firebrick", "blue"), pch=16)

plot(game_by_game15_16$fg3a ~ game_by_game15_16$fg3m, col=c("firebrick", "blue"), pch=16)
```

```{r}
# 3 Pointers Attempted vs 3 Pointers Made KOBEEEE
plot(team_season_stats15_16$FG3M ~ team_season_stats15_16$FG3A, col=c("dodgerblue"),ylim=c(400,1150),main="3 Pointers Attempted vs. 3 Pointers Made",pch=16,xlab="FGM",ylab="FGA")
text(team_season_stats15_16$FG3M ~ team_season_stats15_16$FG3A,labels=team_season_stats15_16$TEAM_NAME, cex= 0.5, pos=3)


# Free Throws Attempted vs Free Throws Made SHAQ Baby
plot(team_season_stats15_16$FTM ~ team_season_stats15_16$FTA, col=c("dodgerblue"),ylim=c(min(team_season_stats15_16$FTM),max(team_season_stats15_16$FTM)),main="FT Attempted vs. FT Made",pch=16,xlab="FTM",ylab="FTA")
text(team_season_stats15_16$FTM ~ team_season_stats15_16$FTA,labels=team_season_stats15_16$TEAM_NAME, cex= 0.5, pos=3)

# Field Goals Attempted vs Field Goals Made
plot(team_season_stats15_16$FGA ~ team_season_stats15_16$FGM, col=c("dodgerblue"),ylim=c(6200,7400),main="FG Attempted vs. FG Made",pch=16,xlab="FGM",ylab="FGA")
text(team_season_stats15_16$FGA ~ team_season_stats15_16$FGM,labels=team_season_stats15_16$TEAM_NAME, cex= 0.5, pos=3)

```

#Logistic Regression Model
The model below uses some stats from a game by game of each team, we train on previous seasons and make our predictions on the current season. We can see our success rate is at about 81% win rate. 
```{r}

fit = glm(wl ~  tov + reb + fgm + fg3m + fgm_opp + tov_opp + reb_opp + fg3m_opp, data = game_by_game14_15, family = binomial)
summary(fit)

y = predict(fit,newdata = game_by_game15_16,type="response")
predicts = as.numeric(y > 0.6)
actuals = game_by_game15_16$wl
mean(predicts == actuals)


prec_recall_summary = function(predicts, actuals) {
  thresh = seq(0, 1, length.out=50)
  prec_rec = data.frame()
  actuals = factor(as.numeric(actuals))
  for (th in thresh) {
    predicts = factor(as.numeric(y >= th), levels=c("0","1"))
    prec_rec = rbind(prec_rec, as.vector(table(predicts, actuals)))
  }
  names(prec_rec) = c("TN", "FP", "FN", "TP")
  prec_rec$threshold = thresh
  prec_rec$precision = prec_rec$TP/(prec_rec$TP + prec_rec$FP)
  prec_rec$recall    = prec_rec$TP/(prec_rec$TP + prec_rec$FN)
  prec_rec$false_pos = prec_rec$FP/(prec_rec$FP + prec_rec$TN)
  return(prec_rec)
}
```


We can see by our ROC graph that our model is doing very well, we ideally want it to be snugged up in the left corner.The plots below indicate the precision and recall. With the threshold at 0.6, about 65% of the teams that play we say actually win, and about 95% of the people who actually win we say they won..
```{r}
prec_rec1 = prec_recall_summary(predicts, actuals)

par(mfrow=c(1,1))
plot(prec_rec1$recall ~ prec_rec1$false_pos, type = "l", col = "red", xlab="Threshold", ylab="Recall")
grid(nx = NULL, ny = NULL, col = "lightgray", lty = "dotted",
     lwd = par("lwd"), equilogs = TRUE)
title("receiver operating characteristic")

par(mfrow=c(1,1))
plot(prec_rec1$precision ~ prec_rec1$recall, type = "l", col = "red", xlab="precision", ylab="recall")
grid(nx = NULL, ny = NULL, col = "lightgray", lty = "dotted",
     lwd = par("lwd"), equilogs = TRUE)
title("Precision recall curve")
```

The method that we came up with was to take all the games from team 1 and team2 then sort them by date. After sorting by date we are able to get the most recent 30 games. We then sample 10 games out of the 30 to get relevant stats for the teams. Take the mean of those 10 games and give a prediction. We state that if a team has higher than a 60% chance of winning we will call it a win.
```{r}
head_to_head = function(team1,team2){

  # get both the team's entire season stats
  firstTeam = game_by_game15_16[game_by_game15_16$team_name == team1,]
  firstTeam$game_date = sort(as.Date(firstTeam$game_date,format = "%b %d, %Y"))
   
  last_10_games_team1 = tail(firstTeam,30)
  last_10_games_team1 = last_10_games_team1[sample(nrow(last_10_games_team1),10), ]
  last_10_games_team1 = lapply(last_10_games_team1[, c("fgm","fg3m","ftm","blk","stl","reb","ast","tov","pf")], mean, na.rm = TRUE)
  
  
  secondTeam = game_by_game15_16[game_by_game15_16$team_name_opp == team2,]
  secondTeam$game_date = sort(as.Date(secondTeam$game_date,format = "%b %d, %Y"))
  last_10_games_team2 = tail(secondTeam,30)
  last_10_games_team2 = last_10_games_team2[sample(nrow(last_10_games_team2),10), ]

     last_10_games_team2 = lapply(last_10_games_team2[, c("fgm_opp","fg3m_opp","ftm_opp","blk_opp","stl_opp","reb_opp","ast_opp","tov_opp","pf_opp")], mean, na.rm = TRUE)

  
  
  x = as.data.frame(last_10_games_team1)
  y = as.data.frame(last_10_games_team2)
  x = cbind(x,y)
  
  # Predicts and rounds the scores
  team1_win_loss = predict(fit, newdata = x, type="response")
  
  team1_win_loss = ifelse(team1_win_loss > 0.6,'W','L')

  return(team1_win_loss)
}
```

The method below simulates a series between two teams. The first two games are at home for team 1, next two are away, then it is alternating until one team reaches 4 wins.
```{r}
series = function(team1,team2) {
  team1_score = 0
  team2_score = 0

  for(i in 1:7) {
    if(team1_score >= 4 | team2_score >= 4){ break }
    if(i <= 2){
      x = head_to_head(team1,team2)
      
      if(x == "W"){
        team1_score = team1_score + 1 
        
      }
      else{
        team2_score = team2_score + 1   
      }
    } else if(i > 2 && i <=4) {
      x = head_to_head(team2,team1)
      
      if(x == "W"){
        team2_score = team2_score + 1
      }
      else{
        team1_score = team1_score + 1  
      }
      
    } else if (i == 5){
      x = head_to_head(team1,team2)
      
      if(x == "W"){
        team1_score = team1_score + 1 
        
      }
      else{
        team2_score = team2_score + 1   
      }
      
    } else if (i == 6) {
      x = head_to_head(team2,team1)
      
      if(x == "W"){
        team2_score = team2_score + 1
      }
      else{
        team1_score = team1_score + 1  
      }
      
    } else if(i == 7) {
      x = head_to_head(team1,team2)
      
      if(x == "W"){
        team1_score = team1_score + 1 
        
      }
      else{
        team2_score = team2_score + 1   
      }
    }
  }
paste0(team1, ": ", team1_score, ", ",team2, ": ", team2_score)
}


```


This method is a modified version of our original head to head that just takes the last 10 games, returns a percentage of winning the game.
```{r}

set.seed(12)
head_to_head_2 = function(team1,team2){

  # get both the team's entire season stats
  firstTeam = game_by_game15_16[game_by_game15_16$team_name == team1,]
  firstTeam$game_date = sort(as.Date(firstTeam$game_date,format = "%b %d, %Y"))
   
  last_10_games_team1 = tail(firstTeam,10)
  last_10_games_team1 = lapply(last_10_games_team1[, c("fgm","fg3m","ftm","blk","stl","reb","ast","tov","pf")], mean, na.rm = TRUE)
  
  
  secondTeam = game_by_game15_16[game_by_game15_16$team_name_opp == team2,]
  secondTeam$game_date = sort(as.Date(secondTeam$game_date,format = "%b %d, %Y"))
  last_10_games_team2 = tail(secondTeam,10)
  last_10_games_team2 = lapply(last_10_games_team2[, c("fgm_opp","fg3m_opp","ftm_opp","blk_opp","stl_opp","reb_opp","ast_opp","tov_opp","pf_opp")], mean, na.rm = TRUE)

  x = as.data.frame(last_10_games_team1)
  y = as.data.frame(last_10_games_team2)
  x = cbind(x,y)
  
  # Predicts and rounds the scores
  team1_win_loss = predict(fit, newdata = x, type="response")
  
  return(team1_win_loss)
}
```

After getting the percentage from above we are now able to check which team won factoring in probabilities.
```{r}
game = function(team1,team2){

  team1_home = head_to_head_2(team1,team2)
  x = sample(c(0,1),1,prob=c(team1_home,(1-team1_home)))
  ifelse(x == 0,return (team1), return (team2))
}
```

We now run a series of 7 games similar to above and take the most appearing winner of each game. This should give us a more accurate result of who actually won.
```{r}
x = c()
series_2 = function(team1,team2) {
  team1_score = 0
  team2_score = 0

  for(i in 1:7) {
    if(team1_score >= 4 | team2_score >= 4){ break }
    if(i <= 2){
      for(i in 1:100){
        y = game(team1,team2)
        x = c(x,y)
      }
     r = table(x)
     winner = max(row.names(r))
     
      if(winner == team1){
        team1_score = team1_score + 1 
      }
      else{
        team2_score = team2_score + 1   
      }
    } else if(i > 2 && i <=4) {
       for(i in 1:100){
        y = game(team2,team1)
        x = c(x,y)
      }
     r = table(x)
     winner = max(row.names(r))
      
      if(winner == team2){
        team2_score = team2_score + 1
      }
      else{
        team1_score = team1_score + 1  
      }
      
    } else if (i == 5){
      for(i in 1:100){
          y = game(team1,team2)
          x = c(x,y)
        }
       r = table(x)
       winner = max(row.names(r))
        
      if(winner == team1) {
        team1_score = team1_score + 1 
        
      }
      else{
        team2_score = team2_score + 1   
      }
      
    } else if (i == 6) {
      for(i in 1:100){
        y = game(team2,team1)
        x = c(x,y)
      }
     r = table(x)
     winner = max(row.names(r))
      
      if(winner == team2){
        team2_score = team2_score + 1
      }
      else{
        team1_score = team1_score + 1  
      }
      
    } else if(i == 7) {
      for(i in 1:100){
            y = game(team1,team2)
            x = c(x,y)
          }
         r = table(x)
         winner = max(row.names(r))
          
        if(winner == team1) {
        team1_score = team1_score + 1 
        
      }
      else{
        team2_score = team2_score + 1   
      }
    }
  }
print(paste0(team1, ": ", team1_score, ", ",team2, ": ", team2_score))
}
```

#1st Round Predictions
```{r}
set.seed(12)
series_2("clippers","blazers")
series_2("warriors","rockets")
series_2("thunder","mavericks")
series_2("spurs","grizzlies")

series_2("cavaliers","pistons")
series_2("hawks","celtics")
series_2("heat","hornets")
series_2("raptors","pacers")


series("clippers","blazers")
series("warriors","rockets")
series("thunder","mavericks")
series("spurs","grizzlies")

series("cavaliers","pistons")
series("hawks","celtics")
series("heat","hornets")
series("raptors","pacers")
```

<br>

```{r}

set.seed(12)
series_2("warriors","blazers")
series_2("thunder","spurs")

series_2("cavaliers","hawks")
series_2("heat","raptors")

series("warriors","blazers")
series("thunder","spurs")

series("cavaliers","hawks")
series("heat","raptors")

```

<br>


```{r}

set.seed(12)
series_2("warriors","thunder")

series_2("cavaliers","raptors")

series("warriors","thunder")

series("cavaliers","raptors")

```





```{r}

set.seed(12)
series_2("warriors","cavaliers")


series("warriors","cavaliers")

```
